{
  "id": "a2a15181-b259-44c8-b5c4-fba04cf2e85e",
  "prefix": "mamulolustur",
  "description": "",
  "body": "\nAlter Procedure xxxsilinecek\nAs\nSet NoCount On\nBegin \n    Begin Try\n\n\n\tDeclare \n\t\t@SPUrunAdi Varchar(100),/*Buradan özellikle UrunTurID gönderilirse içeride dikkate alınacaktır. */\n\t\t@SPStokIslemAkisID int, @SPMamulTipKodu VARCHAR(50), \n\t\t@SPRenkID int, @SPRenkKodu Varchar(30), \n\t\t@SPBaskiDesenVaryantID int, @SPBaskiDesenVaryantKodu Varchar(30),\n\t\t@SPNakisDesenVaryantKodu Varchar(30),\n\t\t@SPTerbiyeIslemTipID int, @SPTerbiyeIslemTipKodu Varchar(20),\n\t\t@SPMamulUrunTID int,@RotaID int\n\n\t\t\n\t\tSet @SPStokIslemAkisID  =151\n\t\tSet @SPRenkID = 8783\n\t\tSet @SPUrunAdi = Null /*ouk otomatik verecek*/\n\t\t\n\t\tSelect @RotaID = IAM.RotaID FROM IT06_StoklarIslemAkis SIA\n\t\tINNER JOIN IT06_IslemAkisM IAM On IAM.IslemAkisMID = SIA.IslemAkisMID\n\t\tWhere SIA.StokIslemAkisID =  @SPStokIslemAkisID\n        \n\t\tDECLARE @MamulUrunTID Int, @StokTipID int, @SysIslemAkisMID int, @MamulKumasUrunTurID int, @MamulKumasUrunGrupID int, @HamUrunTID int, @AnaOlcuBirimID int, @OlcuBirimID int, @UrunTID int\n\n\t\tSet @MamulUrunTID = ISNULL((Select UrunTID \n\t\t\t\t\t\t\t\t\tFrom IT06_Stoklar_MamulKumas \n\t\t\t\t\t\t\t\t\tWhere StokIslemAkisID = @SPStokIslemAkisID And ISNULL(RenkID,-1) = ISNULL(@SPRenkID,-1) And ISNULL(BaskiDesenVaryantID,-1) = ISNULL(@SPBaskiDesenVaryantID,-1) --And ISNULL(NakisDesenVaryantID,-1) = ISNULL(@SPNakisDesenVaryantID,-1)\n\t\t\t\t\t\t\t\t\t\t\tAnd ISNULL(TerbiyeIslemTipID,-1) = ISNULL(@SPTerbiyeIslemTipID,-1)\n\t\t\t\t\t\t\t\t\t),-1)\n\t\tIf @MamulUrunTID = -1 Begin\n\t\t\t--Select @StokTipID = MamulStokTipID, @SysIslemAkisMID = SysIslemAkisMID, @MamulKumasUrunTurID = Case When @NumTalepRenkCalismaID  Is Not null Then NumuneMamulKumasurunTurID else MamulKumasUrunTurID End, @MamulKumasUrunGrupID = MamulKumasUrunGrupID From IT15_System_MamulKumas\n\t\t\tSelect @StokTipID = MamulStokTipID, @AnaOlcuBirimID = AnaOlcuBirimID, @OlcuBirimID = OlcuBirimID From IT15_System_MamulKumas\n\t\n\t\t\tSet @MamulKumasUrunTurID = 1\n\t\t\tSet @MamulKumasUrunGrupID =2\n\n\n\t\t\tSelect @HamUrunTID = UrunTID From IT06_StoklarIslemAkis Where StokIslemAkisID = @SPStokIslemAkisID\n\t\t\t\n\t\t\t--Select  @AnaOlcuBirimID =  S.AnaOlcuBirimID, @OlcuBirimID = S.OlcuBirimID\n\t\t\t--From    IT06_Stoklar_HamKumas SHK \n\t\t\t--\t\tINNER JOIN  IT06_Stoklar S On S.UrunTID = SHK.UrunTID\n\t\t\t--Where   SHK.UrunTID = @HamUrunTID\n\n\t\t\tInsert\tIT06_Stoklar(StokTipID, HamUrunTID, RenkID, AnaOlcuBirimID, OlcuBirimID, RotaID, UrunAdi)\n\t\t\tValues  (@StokTipID, @HamUrunTID, @SPRenkID, @AnaOlcuBirimID, @OlcuBirimID, @RotaID, @SPUrunAdi)\n\t\t\tSet @UrunTID = SCOPE_IDENTITY()\n\n\t\t\tIf ISNULL(@SPRenkID,-1) = -1 And  ISNULL(@SPBaskiDesenVaryantID,-1) = -1 And   ISNULL(@SPTerbiyeIslemTipID,-1) = -1 Begin \n\t\t\t\tRaiserror('Renk Kodu, Baskı Desen Varyant Kodu, Nakış Desen Varyant Kodu ve Terbiye İşlem Tip Kodu alanlarından en az birisi dolu olmalıdır.. ',16,1)\n\t\t\tEND/*26.09.2019 tarihinde renk kodunun zorunluluğunun kaldırılması akabinde ürün kodunu etkileyecek alanların en az birinin dolu olması amacı ile getirilmiştir. TAKAY*/\n\t\t\t\n\t\t\tInsert\tIT06_Stoklar_MamulKumas(UrunTID, MamulKumasUrunTurID, MamulKumasUrunGrupID, HamUrunTID, StokIslemAkisID, RenkID,MamulKumasMenseiID, BaskiDesenVaryantID, TerbiyeIslemTipID,Active)\n\t\t\tValues (@UrunTID, @MamulKumasUrunTurID, @MamulKumasUrunGrupID, @HamUrunTID, @SPStokIslemAkisID, @SPRenkID,1, @SPBaskiDesenVaryantID, @SPTerbiyeIslemTipID,1)\n\n\t\t\tSet @MamulUrunTID = @UrunTID\n\t\tEnd \n\t\tIf @MamulUrunTID Is Null Raiserror('Mamul ürün oluşturulamadı. ',16,1)\n\n\t\tSet @SPMamulUrunTID = @MamulUrunTID\n\n\n\n    End Try \n    Begin Catch\t\n        Declare @ITObjectName nVarchar(126);\n        Set @ITObjectName = Object_Name(@@PROCID);\n        Execute SP15_GenerateError @ITObjectName;\n    End Catch\nEnd\n\n\n        \n\nExec xxxsilinecek\n\t\t\n\n"
}