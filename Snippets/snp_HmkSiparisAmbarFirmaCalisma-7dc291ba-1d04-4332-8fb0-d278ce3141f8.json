{
  "id": "7dc291ba-1d04-4332-8fb0-d278ce3141f8",
  "prefix": "snp_HmkSiparisAmbarFirmaCalisma",
  "description": "",
  "body": "With\r\nctec As (   Select  Distinct FM.FirmaID, F.FirmaAdi, F.FirmaKodu, FM.FisTarihi SonHareketTarihi\r\n            From    IT06_HareketFisM FM\r\n                    Inner Join IT01_Firmalar F On F.FirmaID = FM.FirmaID\r\n            --Order By    F.FirmaAdi\r\n            Union\r\n            Select  Distinct F.FirmaID, F.FirmaAdi, F.FirmaKodu, FM.FisTarihi SonHareketTarihi\r\n            From    IT06_HareketFisM FM\r\n                    Inner Join IT01_Firmalar F On F.FirmaID = FM.TedarikciFirmaID\r\n            Union\r\n            Select  Distinct F.FirmaID, F.FirmaAdi, F.FirmaKodu, FM.FisTarihi SonHareketTarihi\r\n            From    IT06_HareketFisM FM\r\n                    Inner Join IT01_Firmalar F On F.FirmaID = FM.FasoncuFirmaID\r\n            Union\r\n            Select  Distinct F.FirmaID, F.FirmaAdi, F.FirmaKodu, USM.AlinmaTarihi SonHareketTarihi\r\n            From    IT04_UTSiparisM USM\r\n                    Inner Join IT01_Firmalar F On F.FirmaID = USM.FirmaID\r\n            Union\r\n            Select  Distinct F.FirmaID, F.FirmaAdi, F.FirmaKodu, SM.Tarih SonHareketTarihi\r\n            From    IT12_SiparisM SM\r\n                    Inner Join IT01_Firmalar F On F.FirmaID = SM.FirmaID)\r\nSelect      Distinct ctec.FirmaID, ctec.FirmaAdi, ctec.FirmaKodu, MAX(ctec.SonHareketTarihi)\r\nFrom        ctec\r\nGroup By    ctec.FirmaID, ctec.FirmaAdi, ctec.FirmaKodu\r\nOrder By    ctec.FirmaAdi\r\n\r\n\r\n\r\nSelect      Distinct FM.FirmaID, F.FirmaAdi, F.FirmaKodu, MAX(FM.FisTarihi) SonHareketTarihi\r\nFrom        IT06_HareketFisM FM\r\n            Inner Join IT01_Firmalar F On F.FirmaID = FM.FirmaID\r\nWhere       YEAR(FM.FisTarihi) > 2021\r\nGroup By    FM.FirmaID, F.FirmaAdi, F.FirmaKodu\r\n--Order By    F.FirmaAdi\r\n"
}