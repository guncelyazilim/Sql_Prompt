{
  "id": "47c2182b-9376-4057-b031-b2edc15ecbb0",
  "prefix": "snp_create_ht",
  "description": "",
  "body": "Declare  @HareketTipID int,@Tarih SmallDateTime, @FisTurID int, @StokAmbarID int,@StokTipID int,@AmbarID int ,@Miktar_Mt Decimal(18,6),@Miktar_Kg  Decimal(18,6),@Miktar_Ad int,@SPMiktar Decimal(18,6)\nSet @FisTurID  =104\nSet @Tarih = dbo.F15_DatetimeToDate(GETDATE())\n\n Declare c Cursor Local For\n\n \tSelect  SA.StokAmbarID ,S.StokTipID,SA.AmbarID,SA.Miktar_Mt,Sa.Miktar_Kg,SA.Miktar_Ad,\n\tCase \n\tWhen  S.AnaOlcuBirimID = 1 Then  SA.Miktar_Mt\n\tWhen  S.AnaOlcuBirimID = 2 Then  SA.Miktar_Kg\n\tWhen  S.AnaOlcuBirimID = 3 Then  SA.Miktar_Ad end\n\t\n\t From  IT06_StokAmbar SA\n\tINNER JOIN IT05_PartiRotaM PRM On PRM.IsEmriNo = SA.IsEmriNo\n\tINNER JOIN IT01_Ambarlar A On A.AmbarID = SA.AmbarID\n\tINNER JOIN IT06_StokKarti SK On SK.UrunID = SA.UrunID\n\tINNER JOIN IT06_Stoklar S On S.UrunTID = SK.UrunTID\n\tWhere SA.SeriID  =2728907\n \t\t\n Open c\n Fetch Next From c Into @StokAmbarID,@StokTipID,@AmbarID,@Miktar_Mt,@Miktar_Kg,@Miktar_Ad,@SPMiktar\n While @@FETCH_STATUS = 0 Begin\n\n\nExec PSP01_CreateHareketTip @StokTipID = @StokTipID, @AmbarID = @AmbarID, @TrAmbarID = null, @FisTurID = @FisTurID, @IsFason = 0,\n\t\t\t\t\t\t\t@IsDepoGiris = 0, @IsDepoCikis = 0,\n                            @IsIsletmeIciTransfer = 0, @IsIsletmeyeGiris = 0, @IsUretimTuketim = 0, @IsTesislerArasiTransfer = 0, @IsAmbarTeslim = 0,\n                            @IsAmbarTeslimIade = 0, @IsIsletmedenHammaddeIade = 0, @HareketTipID = @HareketTipID Output\n\n \n\n--Exec PSP06_StokAmbar_DuzeltmeCikis @StokAmbarID = @StokAmbarID, @StokTipID = @StokTipID, @AmbarID = @AmbarID, @SPMiktar = @SPMiktar, @SPOlcuBirimKodu = '', @SPMiktar_Mt = @Miktar_Mt,\n--                                   @SPMiktar_Kg = @Miktar_Kg, @SPMiktar_Ad = @Miktar_Ad\n\n\n\t\t\tDeclare @FisDetayID int\n\t\t\tExec SP06_CreateFis_HT @HareketTipID = @HareketTipID, @Miktar_Mt = @Miktar_Mt, @Miktar_kg = @Miktar_Kg, @Miktar_Ad = @Miktar_Ad, @StokAmbarID = @StokAmbarID, @DFirmaID = null, @UrunID = null, @SeriID = null,\n\t\t\t                       @KaliteID = null, @DIsEmriNo = null, @FisDetayID = @FisDetayID Output, @PersonelID = 1, @Tarih = @Tarih, @MFirmaID = null,\n\t\t\t                       @SiparisDetayID = null, @MIsEmriNo = null, @HareketTalepDID = null, @MaliyetMerkezID = null, @DepoCikisID = null\n\t\t\t\n\n \n\n \t\t\t\n \n \tFetch Next From c Into @StokAmbarID,@StokTipID,@AmbarID,@Miktar_Mt,@Miktar_Kg,@Miktar_Ad,@SPMiktar\n End\n Close c\n Deallocate c\n\n"
}