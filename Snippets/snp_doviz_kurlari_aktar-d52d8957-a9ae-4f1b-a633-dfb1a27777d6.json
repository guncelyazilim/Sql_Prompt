{
  "id": "d52d8957-a9ae-4f1b-a633-dfb1a27777d6",
  "prefix": "snp_doviz_kurlari_aktar",
  "description": "",
  "body": "\nSET NOCOUNT ON\n\nDECLARE @BaslangicTarih DATE = CAST('2018-10-30' AS DATE)\n\nPrint 'Set NoCount On '\nPrint 'Set Ansi_Null_Dflt_On On'\n\nSELECT \nCONCAT('INSERT INTO IT01_DovizKurlariM ( KurID, KurTarihi, BankaID ) VALUES (', CAST(DKM.KurID AS VARCHAR(10)), ',', '''', FORMAT(DKM.KurTarihi, N'yyyy-MM-dd'), ''',', CAST(DKM.BankaID AS VARCHAR(10)), ')')\nFROM IT01_DovizKurlariM DKM\nWHERE DKM.KurTarihi > @BaslangicTarih\nORDER BY DKM.KurID ASC\n\nSelect CONCAT('INSERT INTO IT01_DovizKurlariD ( KurDetayID, KurID, DovizID, DovizAlis, DovizSatis, EfektifAlis, EfektifSatis ) VALUES (', \nCAST(DKD.KurDetayID AS VARCHAR(20)), ',', CAST(DKD.KurID AS VARCHAR(20)), ',',CAST(DKD.DovizID AS VARCHAR(10)), ',', \nCAST(IIF(DKD.DovizAlis IS NULL, 'NULL,', CONCAT('''', CAST(DKD.DovizAlis AS VARCHAR(20)), ''',')) AS VARCHAR(20)), \nCAST(IIF(DKD.DovizAlis IS NULL, 'NULL,', CONCAT('''', CAST(DKD.DovizAlis AS VARCHAR(20)), ''',')) AS VARCHAR(20)),  \nCAST(IIF(DKD.EfektifAlis IS NULL, 'NULL,', CONCAT('''', CAST(DKD.EfektifAlis AS VARCHAR(10)), ''',')) AS VARCHAR(20)), \nCAST(IIF(DKD.EfektifSatis IS NULL, 'NULL', CONCAT('''', CAST(DKD.EfektifSatis AS VARCHAR(10)), '''')) AS VARCHAR(20)),\n')') From IT01_DovizKurlariD DKD\nINNER JOIN IT01_DovizKurlariM DKM ON DKM.KurID = DKD.KurID\nWHERE DKM.KurTarihi > @BaslangicTarih\nORDER BY DKD.KurDetayID ASC\n"
}