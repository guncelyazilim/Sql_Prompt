{
  "id": "27f259b5-c6ee-439d-b734-037c37f57fad",
  "prefix": "snp_ObjectsD_Aktarma",
  "description": "ObjectsD bilgilerini aktarır",
  "body": "/*\nİşlevi : ObjectsD ayarlarını script olarak alıp aktarmaya yarar\nKullanımı : Aşağıdaki Script Kaynak Veri Tabanında ilgili View/tablo için çalıştırılır. Oluşan script hedef veri tabanında çalıştırılır.\nDİKKAT: Scipt almadan önce aşağıdaki ayarları yapın \n\t1. Results To text yap\n\t2. \"SSMS > Options > Query Results > SQL Server\" sayfasındaki \"Maximum number of characters displayed in each column\" alanınnı 20.000 gibi büyük bir sayı verin.\n*/\n\nSet NoCount On\n\n\nDeclare @Dunyanin_Enn_Uzun_Degisken_Adini_Yazmaya_Calisayim_Bakayim_Ne_Kadar_Oluyor_Halen_Yazabiliyorum_Gercekten_Cok_Ilginc_Ve_Gereksiz Varchar(100) \n= '$CURSOR$'\n\nPrint 'Set NoCount On '\nPrint 'If Object_Id(''tempdb..#Alanlar'') Is Not Null Drop Table #Alanlar\t' \nPrint 'Create Table #Alanlar(ITObjectName varchar(100), FieldName Varchar(40), FieldCaption Varchar(40), ShowSiraNo int, CaptionSize int, Type tinyint, NotInGrid tinyint, ITRequired tinyint, LField tinyint, LDataSet varchar(50), LKeyFields varchar(50), LLKeyFields varchar(50), LResultField varchar(50), LWhereText varchar(500), LOrderText varchar(500), LDetailDataSet varchar(50))'\n\n\n\n\nSelect  Concat('Insert #Alanlar (ITObjectName, FieldName, FieldCaption, ShowSiraNo, CaptionSize, Type, NotInGrid, ITRequired, LField, LDataSet, LKeyFields, LLKeyFields, LResultField, LWhereText, LOrderText, LDetailDataSet)'+ CHAR(13) +\n\t\t' VALUES(''',OM.ITObjectName, ''',''', OD.FieldName, ''', ''', FieldCaption, ''', ', OD.ShowSiraNo, ', ', OD.CaptionSize, ', ', OD.Type, ', ', IsNull(OD.NotInGrid, 0), ', ', IsNull(OD.ITRequired, 0), ', ', \n\t\t ISNULL(OD.LField,0), ',''', OD.LDataSet, ''',''', OD.LKeyFields, ''',''', OD.LLKeyFields, ''',''', OD.LResultField, ''',''', OD.LWhereText, ''',''', OD.LOrderText, ''',''', OD.LDetailDataSet, ''')')\nFrom\tIT15_ObjectsD OD \n\t\tInner Join IT15_ObjectsM OM On OM.ITObjectID = OD.ITObjectID\nWhere\tOM.ITObjectName = @Dunyanin_Enn_Uzun_Degisken_Adini_Yazmaya_Calisayim_Bakayim_Ne_Kadar_Oluyor_Halen_Yazabiliyorum_Gercekten_Cok_Ilginc_Ve_Gereksiz\n\n\n\nPrint '\nDeclare @chk int\n\nUpdate\tOD Set \n\t\tFieldCaption = A.FieldCaption, \n\t\tShowSiraNo = A.ShowSiraNo, \n\t\tCaptionSize = A.CaptionSize, \n\t\tType = A.Type,\n\t\tNotInGrid = A.NotInGrid,\n\t\tITRequired = A.ITRequired,\n\t\tLField = A.LField, \n\t\tLDataSet = A.LDataSet, \n\t\tLKeyFields = A.LKeyFields, \n\t\tLLKeyFields = A.LLKeyFields, \n\t\tLResultField = A.LResultField, \n\t\tLWhereText = A.LWhereText, \n\t\tLOrderText = A.LOrderText, \n\t\tLDetailDataSet = A.LDetailDataSet\nFrom\tIT15_ObjectsD OD \n\t\tInner Join IT15_ObjectsM OM On OM.ITObjectID = OD.ITObjectID\n\t\tInner Join #Alanlar A On OD.FieldName = A.FieldName COLLATE DATABASE_DEFAULT  And A.ITObjectName = OM.ITObjectName COLLATE DATABASE_DEFAULT \n\n\nSet @chk = @@ROWCOUNT\n\nIf @chk = 0 Raiserror(''Hiç Güncelleme yapılmadı. Muhtemelen bir yanlışlık var.'',16,1)\nElse Print Concat(@chk, '' adet satır güncellendi.'')\n\n'"
}